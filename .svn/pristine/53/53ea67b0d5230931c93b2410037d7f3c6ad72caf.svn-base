#include "USART.h"
#include "buttons.h"
#include <delay.h>
#include <gpio.h>
#include <stm32.h>

void setup_RCC() {
    RCC->AHB1ENR |= RCC_AHB1ENR_GPIOAEN;
    RCC->AHB1ENR |= RCC_AHB1ENR_GPIOBEN;
    RCC->AHB1ENR |= RCC_AHB1ENR_GPIOCEN;
    RCC->APB1ENR |= RCC_APB1ENR_USART2EN;
    __NOP();
}

void setup() {
    setup_RCC();
    USART_setup(BAUDRATE);
    USART_enable();
    buttons_setup();
}

int main() {
    setup();
    for (;;) {
        USART_write_from_buffer();
    }
}
